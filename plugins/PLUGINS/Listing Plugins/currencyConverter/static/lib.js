var currencyConverterClass=function(){this.config=new Array,this.phrases=new Array,this.rates=new Array,this.abbr=new Array,this.first=!0,this.first_f=!0;var self=this;this.boxActions=function(){var e=!0,t=!1;$("#curConv_code").change(function(){$("#curConv_loading").fadeIn(),e=!1,clearTimeout(t),xajax_setCurrency($(this).val())}),$("#curConv_code").click(function(){e=!1}),$("#curConv_change").click(function(){e=!0,$("#curConv_1").hide(),$("#curConv_2").show(),t=setTimeout(function(){e&&($("#curConv_2").hide(),$("#curConv_1").show())},1e4)})},this.convert=function(){if(this.rates[this.config.currency]){var e="sf_field_([0-9]+)_"+this.config.field,t=this.config.show_flags?"background-image: url("+this.config.flags_dir+this.config.currency.toLowerCase()+".png)":"",n=this.config.show_flags?" flag":"",a="after"==this.config.position?"":" disp-block",i="";$("#listings div.item").find("tr:regex(id, "+e+"),span:regex(id, "+e+")").each(function(){var e=!1;switch($(this).get(0).tagName.toLowerCase()){case"tr":if(i="",$(this).find("td:last > a").length>0&&(i=" > a"),self.first){e=trim($(this).find("td:last"+i).html()),$(this).find("td:last"+i).html("");var r='<label class="cc-original'+a+'">'+e+"</label>",o='<label title="'+self.phrases.converted+'" style="'+t+'" class="cc-converted'+n+a+'"></label>';$(this).find("td:last"+i).append("above"==self.config.position?o:r).append("above"==self.config.position?r:o)}else e=trim($(this).find("td:last"+i+" label.cc-original").html()),$(this).find("td:last"+i+" label.cc-converted").attr("style",t);break;case"span":if(i=$(this).find("> a").length>0?$(this).find("> a"):$(this),self.first){e=trim($(i).html()),$(i).html("");var r='<label class="cc-original'+a+'">'+e+"</label>",o='<label title="'+self.phrases.converted+'" style="'+t+'" class="cc-converted'+n+a+'"></label>';$(i).append("above"==self.config.position?o:r).append("above"==self.config.position?r:o)}else e=trim($(i).find("label.cc-original").html()),$(i).find("label.cc-converted").attr("style",t)}var s=self.decodePrice(e);if(s&&s.key!=self.config.currency&&s.price){var l=self.inRange(s.currency),c=s.price/l,d=self.inRange(self.config.currency,!0),u=c*d;$(this).find("label.cc-converted").show().html(self.encodePrice(u)),$(this).find("label.cc-original").css("opacity",.7)}else $(this).find("label.cc-converted").hide(),$(this).find("label.cc-original").css("opacity",1)}),this.config.featured&&(e="flf_([0-9]+)_"+this.config.field,i="",$("ul.featured li.item").find("ul > li:regex(id, "+e+")").each(function(){var e=!1;if(i=$(this).find("> a").length>0?$(this).find("> a"):$(this),self.first_f){e=trim($(i).html()),$(i).html("");var r='<label class="cc-original'+a+'">'+e+"</label>",o='<label title="'+self.phrases.converted+'" style="'+t+'" class="cc-converted'+n+a+'"></label>';$(i).append("above"==self.config.position?o:r).append("above"==self.config.position?r:o)}else e=trim($(i).find("label.cc-original").html()),$(i).find("label.cc-converted").attr("style",t);var s=self.decodePrice(e);if(s&&s.key!=self.config.currency&&s.price){var l=self.inRange(s.currency),c=s.price/l,d=self.inRange(self.config.currency,!0),u=c*d;$(this).find("label.cc-converted").show().html(self.encodePrice(u)),$(this).find("label.cc-original").css("opacity",.7)}else $(this).find("label.cc-converted").hide(),$(this).find("label.cc-original").css("opacity",1)}),this.first_f=!1),$("td.details tr[id=df_field_"+this.config.field+"] td:last").each(function(){var e=!1;if(self.first){e=trim($(this).html()),$(this).html("");var i='<label class="cc-original'+a+'">'+e+"</label>",r='<label title="'+self.phrases.converted+'" style="'+t+'" class="cc-converted'+n+a+'"></label>';$(this).append("above"==self.config.position?r:i).append("above"==self.config.position?i:r)}else e=trim($(this).find("label.cc-original").html()),$(this).find("label.cc-converted").attr("style",t);var o=self.decodePrice(e);if(o&&o.key!=self.config.currency&&o.price){var s=self.inRange(o.currency),l=o.price/s,c=self.inRange(self.config.currency,!0),d=l*c;$(this).find("label.cc-converted").show().html(self.encodePrice(d)),$(this).find("label.cc-original").css("opacity",.7)}else $(this).find("label.cc-converted").hide(),$(this).find("label.cc-original").css("opacity",1)}),this.first=!1}},this.inRange=function(e,t){if(!this.rates)return!1;if(t)return this.rates[e][0];for(var n in this.rates)if($.inArray(e,this.rates[n][1])>=0)return this.rates[n][0];return!1},this.encodePrice=function(str,hide_currency,hide_separator){if(!str)return!1;str=str.toFixed(2),eval("var converted = '"+str+"'");var index=converted.indexOf("."),rest=this.config.show_cents?".00":"";index>=0&&(rest=converted.substring(index),".00"!=rest||this.config.show_cents||(rest=""),converted=converted.substring(0,index));var res="";if(!hide_separator){converted=converted.reverse();for(var i=0;i<converted.length;i++){var char=converted.charAt(i);res+=char;var j=i+1;0==j%3&&j!=converted.length&&(res+=this.config.price_delimiter)}converted=res.reverse()}return hide_currency?converted+=rest:converted=this.rates[this.config.currency][1][0]+" "+converted+rest,converted=this.config.show_flags||"after"!=this.config.position?converted:" - "+converted},this.decodePrice=function(e){if(!e)return!1;var t=new Array;t.currency=t.key=!1;var n=new RegExp("(<.*?>)","ig");e=trim(e.replace(n,""));var a="^([A-Za-z\\W]{1,3})?\\s*?([0-9.,':;\"]+)\\s*?([A-Za-z\\W]{1,3})?$",i=e.match(a);if(!i)return!1;if(!i[1]&&!i[3])return!1;t.currency=i[1]?trim(i[1]):trim(i[3]);for(var r in this.rates)$.inArray(t.currency,this.rates[r][1])>=0&&(t.key=r);if(e=i[2],""!=this.config.price_delimiter){var o=new RegExp("\\"+this.config.price_delimiter,"gi");e=e.replace(o,"")}return e=parseInt(e),t.price=e,t}},currencyConverter=new currencyConverterClass;jQuery.expr[":"].regex=function(e,t,n){var a=n[3].split(","),i=/^(data|css):/,r={method:a[0].match(i)?a[0].split(":")[0]:"attr",property:a.shift().replace(i,"")},o="ig",s=new RegExp(a.join("").replace(/^\s+|\s+$/g,""),o);return s.test(jQuery(e)[r.method](r.property))},"function"!=typeof window.reverse&&(String.prototype.reverse=function(){for(var e="",t=this.length;t>0;)e+=this.substring(t-1,t),t--;return e});