Ext.BLANK_IMAGE_URL=rlUrlHome+"img/ext/default/s.gif";var CommentGrid=function(){$("#rl_comment_grid").html(""),Ext.onReady(function(){var e=20,t=Ext.data.Record.create([{name:"ID",mapping:"ID"},{name:"Title",mapping:"Title"},{name:"Description",mapping:"Description"},{name:"Author",mapping:"Author"},{name:"Status",mapping:"Status"},{name:"Date",mapping:"Date",type:"date",dateFormat:"Y-m-d H:i:s"}]),a=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:rlPlugins+"comment/admin/comment.inc.php?q=ext",method:"GET"}),reader:new Ext.data.JsonReader({root:"data",totalProperty:"total",remoteSort:!0,id:"ID"},t)});a.setDefaultSort("Date","asc"),Ext.namespace("Ext.exampledata"),Ext.exampledata.status=[[lang.ext_active,"active"],[lang.ext_approval,"approval"]];var n=new Ext.data.SimpleStore({fields:["value","key"],data:Ext.exampledata.status}),i=new Ext.grid.ColumnModel([{header:lang.ext_title,dataIndex:"Title",width:80},{header:lang.ext_author,dataIndex:"Author",width:20,id:"rlExt_item_bold",renderer:function(e){var t=e.split("||")[0],a=e.split("||")[1];if("0"==a)var n="<span>"+t+"</span>";else var n="<span ext:qtip='"+lang.ext_click_to_view_details+"' style='cursor: pointer;' onClick='location.href=\""+rlUrlHome+"index.php?controller=accounts&action=view&username="+t+"\"'>"+t+"</span>";return n}},{header:lang.ext_add_date,dataIndex:"Date",width:17,renderer:function(e){var t=Ext.util.Format.dateRenderer(rlDateFormat.replace(/%/g,"").replace("b","M"))(e);return t='<span class="build">'+t+"</span>"}},{header:lang.ext_status,dataIndex:"Status",width:10,editor:new Ext.form.ComboBox({store:n,displayField:"value",valueField:"key",typeAhead:!0,mode:"local",triggerAction:"all",selectOnFocus:!0})},{header:lang.ext_actions,width:10,dataIndex:"ID",sortable:!1,renderer:function(e){return"<center><span onClick='location.href=\""+rlUrlHome+"index.php?controller="+controller+"&action=edit&comment="+e+"\"' class='edit'>"+lang.ext_edit+"</span><span class='blue_11_bold_link'> | </span><span onClick='rlConfirm( \""+lang["ext_notice_"+delete_mod]+'", "xajax_deleteComment", "'+Array(e)+"\", \"news_load\" )' class='delete'>"+lang.ext_delete+"</a></center>"}}]);i.defaultSortable=!0;var o=new Ext.grid.EditorGridPanel({el:"rl_comment_grid",autoWidth:!0,autoHeight:!0,monitorResize:!0,doLayout:function(){wsize=Ext.getBody().getWidth(),this.setSize(wsize-214),Ext.grid.GridPanel.prototype.doLayout.call(this)},title:lang.ext_manager,store:a,clicksToEdit:1,cm:i,trackMouseOver:!1,loadMask:{msg:lang.ext_loading},viewConfig:{forceFit:!0,enableRowBody:!0,showPreview:!1},bbar:new Ext.PagingToolbar({beforePageText:lang.ext_page,afterPageText:lang.ext_of+" {0}",pageSize:e,store:a,displayInfo:!0,displayMsg:lang.ext_display_items,emptyMsg:lang.ext_no_items})});o.render(),a.load({params:{start:0,limit:e}}),o.addListener("afteredit",function(e){if("Date"==e.field){var t=new Date(e.value);e.value=t.format("Y-m-d")}Ext.Ajax.request({waitMsg:"Saving changes...",url:rlPlugins+"comment/admin/comment.inc.php?q=ext",method:"GET",params:{action:"update",type:e.grid.type,id:e.record.id,field:e.field,value:e.value},failure:function(){Ext.MessageBox.alert("Error saving changes...")},success:function(){o.store.commitChanges()}})})})};